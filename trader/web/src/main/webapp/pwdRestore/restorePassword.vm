#parse("/WEB-INF/resources/include/meta/htmlDescriptor.vm")
<html>
<head>
    <title>$betext.get("restorePassword.title")</title>
    <link rel='stylesheet' href='$link.setRelative("css/main.css")' type='text/css'>
    <link rel='stylesheet' href='$link.setRelative("css/basepage.css")' type='text/css'>
    <link rel='stylesheet' href='$link.setRelative("css/common.css")' type='text/css'>
    #parse("/WEB-INF/resources/include/meta/content-type.vm")
    #* #parse("/WEB-INF/resources/include/meta/nocache.vm") *#
    #parse("/WEB-INF/resources/layout/noscript.vm")
    <script type="text/javascript" src='$link.setRelative("js/utils.js")'></script>
    <script type="text/javascript" src='$link.setRelative("js/commonValidations.js")'></script>
    <script type="text/javascript" src='$link.setRelative("js/publicValidations.js")'></script>
    <script type="text/javascript">

        var sAvailableURLAction    = '$link.setForward("availabLeSsoUrlAction")';
        var sPictureTestFailsAlert = '$betext.get("errors.jcaptcha_error")';
        var sNoSSOAvailableAlert   = '$betext.get("errors.NO_SSO_AVAILABLE")';

        function getAvailableURL() {
            newTs++;
            if (window.frames['uManager']) {
                window.frames['uManager'].location.replace(sAvailableURLAction +"?submitAction=$!restorePasswordForm.newPasswordAction");
            }
        }

        function getPicture() {
            newTs++;
            if (window.frames['uManager']) {
                window.frames['uManager'].location.replace(sAvailableURLAction +"?submitAction=$!restorePasswordForm.pictureAction");
            }
        }

        function continueSubmitWith(_ssoURL, _actionURI) {
          if (_ssoURL == null || _ssoURL == "" ) {
           alert(sNoSSOAvailableAlert);
           return;
          }

          if (_ssoURL == ssoURL) {
            document.forms.restorePasswordForm.action = _ssoURL + _actionURI;
            processOnClickForSubmit(document.forms.restorePasswordForm.submitButton, true);
            document.forms.restorePasswordForm.submit();
          } else {
            alert(sPictureTestFailsAlert);
            getPicture();
          }
        }

        function submitForm(thisForm) {
            if (validateRestorePasswordForm(thisForm)) {
                getAvailableURL();
            }
        }

        var newTs = 0;
        var ssoURL = null;

        function loadPicture(_ssoURL, _actionURI) {
         ssoURL = _ssoURL;
         var captchaImage = document.getElementById("jcaptcha_image");
            if (captchaImage) {
              newTs++;
              captchaImage.src = ssoURL + _actionURI + "?ts="+ newTs;
            }
        }
    </script>

</head>
<body onload='getPicture();'>

#if ($request.getParameter("close"))
<script type="text/javascript">
    window.close();
</script>
#end

$validator.getJavascript()
<table cellpadding='0' cellspacing='0' border='0' width='100%' height='100%'>
    <tr>
        <td>
            <table border='0' cellspacing='1' cellpadding='0' width='100%' height='100%'>
                <form name="restorePasswordForm" method='POST' action=''>
                    <input type='hidden' name='failedUri' value='$restorePasswordForm.encodedFailedUri'>
                    <input type="hidden" name="succeedUri" value='$restorePasswordForm.encodedSucceedUri'>
                    <input type="hidden" name="strLocale" value="$logonForm.locale.language">
                    <tr>
                        <td align='center' width='100%' height='40px'>
                            <table border='0' cellspacing='0' cellpadding='0' width='100%' height='100%'
                                   class="table-top">
                                <tr>
                                    <td width='165px'>
                                        <table border='0' cellspacing='0' cellpadding='0' width='100%' height='100%'>
                                            <tr>
                                                <td nowrap width='165px' class="table-top-version">
                                                    $betext.get("top.logo1") $betext.get("login.version")
                                                    $!application.getAttribute("version")
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                    <td class="table-top-title" style="text-align:right; padding-right:10px;">
                                        $betext.get("restorePassword.title")
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td width='2px'>
                            <iframe name="uManager" id="uManager" width="0" height="0" marginwidth="0" marginheight="0" frameborder="0" style="visibility:hidden;"></iframe>
                        </td>
                    </tr>
                    <tr>
                        <td class='area-border-white'>
                            <table cellpadding='1' cellspacing='2' border='0' width='100%'>
                                <tr>
                                    <td colspan='2' align='center'>
                                        <table border='0' cellspacing='0' cellpadding='0' width='80%'>
                                            <tr>
                                                <td align='left'>$betext.get("restorePassword.note")</td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan='2' height="20px" align='center'><br>$betext.get("regUser.requiredDataWarning")
                                    </td>
                                </tr>
                                <tr>
                                    <td width="40%" align="right">$betext.get("restorePassword.login"):</td>
                                    <td><input type="text" name="login" size="20" value='$!restorePasswordForm.login'
                                               maxlength="30">
                                        &nbsp;#parse("/WEB-INF/resources/layout/required.vm")
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right">$betext.get("restorePassword.email"):</td>
                                    <td><input type="text" name="email" size="40" value='$!restorePasswordForm.email' maxlength="100"> &nbsp;#parse("/WEB-INF/resources/layout/required.vm")</td>
                                </tr>
                                <tr>
                                    <td align="left">&nbsp;</td>
                                    <td>
                                        <table cellSpacing='0' cellPadding='0' border='0' >
                                        <tr>
                                         <td><img src='$link.setRelative("images/login/spacer.gif")' alt='' id='jcaptcha_image'/></td>
                                         <td title='$betext.get("regUser.jcaptchaAltText")'>&nbsp;<a href='#' onclick='getPicture();'><b>$betext.get("regUser.cantsee")</b></a></td>
                                         </tr>
                                       </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right">$betext.get("regUser.jcaptcha_prompt"):</td>
                                    <td align="left"><input type="text" name="jcaptcha_response" size="30"  maxlength="30"/>&nbsp;#parse("/WEB-INF/resources/layout/required.vm")</td>
                                </tr>
                            </table>
                        </td>
                        <td width='2px'></td>
                    </tr>
                    <tr>
                        <td class='area-border-white' width='100%' height='30px'>
                            <table border='0' cellspacing='2' cellpadding='0' width='100%' height='100%'>
                                <tr>
                                    <td>
                                        <input type="button"
                                               value='$betext.get("restorePassword.close")'
                                               title='$betext.get("restorePassword.close")'
                                               onMouseOver='this.className="highlight"'
                                               onMouseOut='this.className=""'
                                               onClick=" bCancel=true; window.close();">

                                        <input type="button" name="submitButton"  value='$betext.get("restorePassword.submit")' onclick='submitForm(this.form)'>
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td width='2px'></td>
                    </tr>
                </form>
            </table>
        </td>
    </tr>
    <tr>
        <td height='1px'>#jsMessageMarkup()</td>
    </tr>
</table>
</body>
</html>