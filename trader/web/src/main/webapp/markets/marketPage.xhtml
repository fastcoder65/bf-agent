<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">
	<rich:panel bodyClass="inPanelBody">
		<f:facet name="header">
			<h:outputText value="All markets"/>
		</f:facet>

		<ui:remove>ondblclick="#{marketBean.addToActiveMarkets}"
			<a4j:actionListener  listener="#{marketBean.addToActiveMarkets}"/>
			<a4j:ajax event="dblclick" listener="#{marketBean.addToActiveMarkets}" />
		</ui:remove>

		<a4j:jsFunction name="doSelectMarket" action="#{marketBean.add2ActiveMarkets}">
			<a4j:param  name="id" assignTo="#{marketBean.selectedMarketId}"></a4j:param>
		</a4j:jsFunction>

		<div>
			<h:form>
				<rich:tree toggleType="ajax" var="item"
						   nodeClass="net.bir.web.beans.treeModel.Entry"
						   toggleListener="#{marketBean.toggleListener}"
						   selectionChangeListener="#{marketBean.selectionChanged}"
						>

					<rich:treeModelRecursiveAdaptor roots="#{marketBean.rootNodes}" nodes="#{item.children}">
						<rich:treeNode  title="#{item.name} (#{item.type})"
										iconExpanded="images/tree-help/ftv2folderopen.gif"
										iconCollapsed="images/tree-help/ftv2folderclosed.gif"
								>#{item.name}</rich:treeNode>

						<rich:treeModelAdaptor rendered="#{item.marketNode}"  nodes="#{item.markets}">

							<rich:treeNode title="#{item.name} (#{item.market.description.marketTime})"
										   iconExpanded="images/tree-help/ftv2doc.gif"
										   iconCollapsed="images/tree-help/ftv2doc.gif"
											ondblclick="doSelectMarket('#{item.id}')"
									>
									<h:outputText value="#{item.name}"></h:outputText>


							</rich:treeNode>
						</rich:treeModelAdaptor>
					</rich:treeModelRecursiveAdaptor>
				</rich:tree>
			</h:form>
		</div>
	</rich:panel>

</ui:composition>



